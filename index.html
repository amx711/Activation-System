<!doctype html>
<html lang="ar" class="dark" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Respect City - التفعيل </title>
  <link rel="icon" type="image/png" href="logo.png" />
<style>
    @import url('https://fonts.googleapis.com/css2?family=Alexandria:wght@100..900&display=swap');

    body {
        font-family: 'Alexandria', sans-serif;
    }

    /* Popup Styles */
    #welcome-popup, #error-popup {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        backdrop-filter: blur(5px);
    }

    #welcome-popup.hidden, #error-popup.hidden {
        display: none;
    }

    .popup-content {
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        border: 2px solid #6366f1;
        border-radius: 20px;
        padding: 2.5rem;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 20px 60px rgba(99, 102, 241, 0.3);
        animation: slideIn 0.4s ease-out;
        text-align: center;
    }

    .error-popup-content {
        background: linear-gradient(135deg, #991b1b 0%, #7f1d1d 100%);
        border: 2px solid #ef4444;
        border-radius: 20px;
        padding: 2.5rem;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 20px 60px rgba(239, 68, 68, 0.3);
        animation: slideIn 0.4s ease-out;
        text-align: center;
    }

    @keyframes slideIn {
        from {
            transform: translateY(-50px);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    .popup-title {
        font-size: 1.8rem;
        font-weight: bold;
        color: #6366f1;
        margin-bottom: 1.5rem;
        text-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
    }

    .error-popup-title {
        font-size: 1.8rem;
        font-weight: bold;
        color: #ef4444;
        margin-bottom: 1.5rem;
        text-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
    }

    .popup-text {
        font-size: 1.1rem;
        line-height: 1.8;
        color: #e5e7eb;
        margin-bottom: 2rem;
        direction: rtl;
        text-align: right;
    }

    .popup-close-btn {
        background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
        color: white;
        border: none;
        padding: 0.75rem 2rem;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
    }

    .error-popup-btn {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
        border: none;
        padding: 0.75rem 2rem;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
    }

    .popup-close-btn:hover, .error-popup-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(99, 102, 241, 0.6);
    }

    .error-popup-btn:hover {
        box-shadow: 0 6px 20px rgba(239, 68, 68, 0.6);
    }

    .popup-close-btn:active, .error-popup-btn:active {
        transform: translateY(0);
    }
</style>
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            surface: '#0b0f19',
            card: '#111827',
            primary: '#6366f1',
            textmuted: '#9ca3af',
          },
        },
      },
    };
  </script>
</head>

<body class="bg-surface text-gray-100 min-h-screen flex flex-col">
  
  <!-- Welcome Popup -->
  <div id="welcome-popup" class="hidden">
    <div class="popup-content">
      <h2 class="popup-title">أهلاً بك في ريسبيكت سيتي</h2>
      <div class="popup-text">
        اتبع الخطوات التالية للتفعيل:<br><br>
        ✅ اختر اللغة من الأعلى<br>
        ✅ املأ الأسئلة المطلوبة<br>
        ✅ ثم اضغط إرسال<br><br>
        نتمنى لك تجربة سهلة وسريعة<br>
        💜 إدارة ريسبيكت سيتي
      </div>
      <button class="popup-close-btn" onclick="closePopup()">ابدأ الآن</button>
    </div>
  </div>

  <!-- Error Popup -->
  <div id="error-popup" class="hidden">
    <div class="error-popup-content">
      <h2 class="error-popup-title">⚠️ خطأ في المعلومات</h2>
      <div class="popup-text">
        هناك نقص في المعلومات<br><br>
        اعد طلب معرف جديد من البوت<br><br>
        وفي حال تكرار المشكلة كلم الإدارة
      </div>
      <button class="error-popup-btn" onclick="closeWindow()">حسناً</button>
    </div>
  </div>

  <main class="flex-grow container mx-auto px-4 py-8 max-w-3xl">

    <!-- Header -->
    <header class="flex items-center justify-between mb-2">
      <img src="logo.png" alt="Logo" class="h-12 rounded-lg" />
      <h1 id="title" class="text-3xl font-bold text-white">تفعيل القائمة البيضاء</h1>
      <div class="flex gap-2">
        <button id="lang-ar" class="px-3 py-1 rounded bg-card border border-gray-700">العربية <img src="ar.png" alt="العربية" class="inline-block w-7 h-7 ml-1" />  </button>
        <button id="lang-en" class="px-3 py-1 rounded bg-card border border-gray-700">English <img src="https://cdn-icons-png.flaticon.com/512/12339/12339692.png" alt="English" class="inline-block w-4 h-4 ml-1" /></button>
      </div>
    </header>

    <!-- Avatar + DisplayName + ID -->
    <section class="flex flex-col items-center mb-8">
      <div class="w-32 h-32 rounded-full overflow-hidden border-4 border-primary">
        <img id="avatar" class="object-cover w-full h-full" alt="User avatar" />
      </div>
      <h2 id="display-name" class="mt-4 text-xl font-semibold text-white">—</h2>
      <p id="user-id" class="text-gray-400">ID: —</p>
    </section>

    <!-- Form -->
    <form id="whitelist-form" class="space-y-6 bg-card rounded-lg p-6 border border-gray-700">
      <input type="hidden" id="parsed-id" name="id" />

      <div>
        <label for="discord" class="block text-sm text-gray-400 mb-1">معرّف ديسكورد</label>
        <input id="discord" name="discord" type="text" disabled required placeholder="1234567890"
               class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none">
      </div>

      <div>
        <label for="realName" class="block text-sm text-gray-400 mb-1">1/8. اسمك الحقيقي</label>
        <input id="realName" name="realName" type="text" required placeholder="أدخل اسمك الحقيقي"
               class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none">
      </div>

      <div>
        <label for="age" class="block text-sm text-gray-400 mb-1">2/8. عمرك</label>
        <input id="age" name="age" type="number" required placeholder="أدخل عمرك"
               class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none">
      </div>

      <div>
        <label for="robloxName" class="block text-sm text-gray-400 mb-1">3/8. اسم حسابك في روبلوكس</label>
        <input id="robloxName" name="robloxName" type="text" required placeholder="أدخل اسم حسابك في روبلوكس"
               class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none">
      </div>

      <div>
        <label for="charName" class="block text-sm text-gray-400 mb-1">4/8. اسم شخصيتك</label>
        <input id="charName" name="charName" type="text" required placeholder="أدخل اسم شخصيتك"
               class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none">
      </div>

      <div>
        <label for="charAge" class="block text-sm text-gray-400 mb-1">5/8. عمر شخصيتك</label>
        <input id="charAge" name="charAge" type="number" required placeholder="أدخل عمر شخصيتك"
               class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none">
      </div>

      <div>
        <label for="charStory" class="block text-sm text-gray-400 mb-1">6/8. قصة شخصيتك</label>
        <textarea id="charStory" name="charStory" rows="4" required placeholder="اكتب قصة شخصيتك بالتفصيل..."
                  class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none"></textarea>
      </div>

      <div>
        <label for="weaponScenario" class="block text-sm text-gray-400 mb-1">7/8. اذا احد رفع عليك سلاح وش تسوي؟</label>
        <textarea id="weaponScenario" name="weaponScenario" rows="3" required placeholder="اكتب إجابتك هنا..."
                  class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none"></textarea>
      </div>

      <div>
        <label for="deathScenario" class="block text-sm text-gray-400 mb-1">8/8. اذا متت في سيناريو هل ترجع للسيناريو؟</label>
        <textarea id="deathScenario" name="deathScenario" rows="3" required placeholder="اكتب إجابتك هنا..."
                  class="w-full px-3 py-2 rounded bg-surface border border-gray-700 focus:ring-2 focus:ring-primary outline-none"></textarea>
      </div>

      <div class="flex items-center gap-3">
        <button type="submit"
                class="px-4 py-2 bg-primary text-white rounded hover:bg-indigo-500 transition">
          إرسال
        </button>
        <span id="status" class="text-sm text-textmuted ml-auto"></span>
      </div>
    </form>
  </main>

  <footer class="text-center text-xs text-gray-500 py-4">
    © <span id="year"></span> Respect City RP. جميع الحقوق محفوظة.
  </footer>

   <footer class="text-center text-xs text-gray-500 py-4">
    Made with ❤️ by <a href="https://github.com/amx711" target="_blank">Amx711</a>
  </footer>


  <script>
    const qs = s => document.querySelector(s);
    const webhookUrl = "";
    const CONFIG = {
      fallbackAvatar: id => `https://avatars.dicebear.com/api/identicon/${encodeURIComponent(id)}.svg`,
    };

    function closePopup() {
      document.getElementById('welcome-popup').classList.add('hidden');
    }

    function closeWindow() {
      window.close();
      setTimeout(() => {
        window.location.href = 'about:blank';
      }, 100);
    }

function getParams() {
  const url = new URL(window.location.href);
  const encoded = url.searchParams.get('data');
  if (!encoded) return null;

  try {
    const decoded = JSON.parse(atob(encoded));

    const params = {
      id: decoded.id || '',
      name: decoded.name || '',
      avatar: decoded.avatar || ''
    };

    if (!params.id || !params.name || !params.avatar) {
      return null;
    }

    return params;
  } catch (err) {
    console.error('❌ Failed to decode data:', err);
    return null;
  }
}

    function loadAvatar(id, avatarUrl) {
      const img = qs('#avatar');
      img.src = avatarUrl || CONFIG.fallbackAvatar(id);
    }

    async function submitForm(e) {
      e.preventDefault();
      const payload = {
        id: qs('#parsed-id').value || qs('#discord').value,
        discord: qs('#discord').value,
        realName: qs('#realName').value,
        age: qs('#age').value,
        robloxName: qs('#robloxName').value,
        charName: qs('#charName').value,
        charAge: qs('#charAge').value,
        charStory: qs('#charStory').value,
        weaponScenario: qs('#weaponScenario').value,
        deathScenario: qs('#deathScenario').value,
      };
      qs('#status').textContent = 'جاري الإرسال...';
      try {
    const res = await fetch(webhookUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
  content:
    `**تفعيل قائمة بيضاء جديد**\n` +
    `**معرّف ديسكورد:** ${payload.discord}\n` +
    `**منشن الشخص :** <@!${payload.discord}>\n` +
    `**الاسم الحقيقي:** ${payload.realName}\n` +
    `**العمر:** ${payload.age}\n` +
    `**اسم روبلوكس:** ${payload.robloxName}\n` +
    `**اسم الشخصية:** ${payload.charName}\n` +
    `**عمر الشخصية:** ${payload.charAge}\n` +
    `**قصة الشخصية:** ${payload.charStory}\n` +
    `**اذا احد رفع عليك سلاح وش تسوي؟** ${payload.weaponScenario}\n` +
    `**اذا متت في سيناريو هل ترجع للسيناريو؟** ${payload.deathScenario}`,
        username: 'Activation System - نظام التفعيل',
        avatar_url: 'https://avatars.githubusercontent.com/u/167096144?s=400&u=00f54e886f0fceda60a85c4efc174ca7788445d0&v=4',
      }),
    });
        if (!res.ok) throw new Error();
        qs('#status').textContent = '✅ تم الإرسال بنجاح!';
      } catch {
        qs('#status').textContent = '❌ فشل الإرسال.';
      }
      setTimeout(()=>qs('#status').textContent='',3000);
      setTimeout(() => {
        window.open ('https://discord.gg/', '_self').close();
      }, 5000);
    }

    const i18n = {
      en: {
        title: 'Whitelist Activation',
        discord: 'Discord ID',
        realName: '1/8. Your Real Name',
        age: '2/8. Your Age',
        robloxName: '3/8. Your Roblox Username',
        charName: '4/8. Character Name',
        charAge: '5/8. Character Age',
        charStory: '6/8. Character Story',
        weaponScenario: '7/8. What would you do if someone pulled a weapon on you?',
        deathScenario: '8/8. If you die in a scenario, do you return to the scenario?',
        submit: 'Submit',
        sending: 'Sending...',
        success: '✅ Sent successfully!',
        failed: '❌ Failed to send.',
        footer: 'All rights reserved.',
        placeholderRealName: 'Enter your real name',
        placeholderAge: 'Enter your age',
        placeholderRoblox: 'Enter your Roblox username',
        placeholderCharName: 'Enter your character name',
        placeholderCharAge: 'Enter your character age',
        placeholderCharStory: 'Write your character story in detail...',
        placeholderWeapon: 'Write your answer here...',
        placeholderDeath: 'Write your answer here...',
      },
      ar: {
        title: 'تفعيل القائمة البيضاء',
        discord: 'معرّف ديسكورد',
        realName: '1/8. اسمك الحقيقي',
        age: '2/8. عمرك',
        robloxName: '3/8. اسم حسابك في روبلوكس',
        charName: '4/8. اسم شخصيتك',
        charAge: '5/8. عمر شخصيتك',
        charStory: '6/8. قصة شخصيتك',
        weaponScenario: '7/8. اذا احد رفع عليك سلاح وش تسوي؟',
        deathScenario: '8/8. اذا متت في سيناريو هل ترجع للسيناريو؟',
        submit: 'إرسال',
        sending: 'جاري الإرسال...',
        success: '✅ تم الإرسال بنجاح!',
        failed: '❌ فشل الإرسال.',
        footer: 'جميع الحقوق محفوظة.',
        placeholderRealName: 'أدخل اسمك الحقيقي',
        placeholderAge: 'أدخل عمرك',
        placeholderRoblox: 'أدخل اسم حسابك في روبلوكس',
        placeholderCharName: 'أدخل اسم شخصيتك',
        placeholderCharAge: 'أدخل عمر شخصيتك',
        placeholderCharStory: 'اكتب قصة شخصيتك بالتفصيل...',
        placeholderWeapon: 'اكتب إجابتك هنا...',
        placeholderDeath: 'اكتب إجابتك هنا...',
      },
    };

    function setLang(lang) {
      const d = i18n[lang];
      document.documentElement.lang = lang;
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      qs('#title').textContent = d.title;
      document.querySelector("label[for=discord]").textContent = d.discord;
      document.querySelector("label[for=realName]").textContent = d.realName;
      document.querySelector("label[for=age]").textContent = d.age;
      document.querySelector("label[for=robloxName]").textContent = d.robloxName;
      document.querySelector("label[for=charName]").textContent = d.charName;
      document.querySelector("label[for=charAge]").textContent = d.charAge;
      document.querySelector("label[for=charStory]").textContent = d.charStory;
      document.querySelector("label[for=weaponScenario]").textContent = d.weaponScenario;
      document.querySelector("label[for=deathScenario]").textContent = d.deathScenario;
      qs('button[type=submit]').textContent = d.submit;
      qs('#realName').placeholder = d.placeholderRealName;
      qs('#age').placeholder = d.placeholderAge;
      qs('#robloxName').placeholder = d.placeholderRoblox;
      qs('#charName').placeholder = d.placeholderCharName;
      qs('#charAge').placeholder = d.placeholderCharAge;
      qs('#charStory').placeholder = d.placeholderCharStory;
      qs('#weaponScenario').placeholder = d.placeholderWeapon;
      qs('#deathScenario').placeholder = d.placeholderDeath;
      document.querySelectorAll('footer')[0].innerHTML = `© <span id="year">${new Date().getFullYear()}</span> Respect City RP. ${d.footer}`;
    }

    document.addEventListener('DOMContentLoaded', () => {
      qs('#year').textContent = new Date().getFullYear();

      const params = getParams();
      
      if (!params) {
        document.getElementById('error-popup').classList.remove('hidden');
        return; 
      }
      document.getElementById('welcome-popup').classList.remove('hidden');
      
      const { id, name, avatar } = params;
      qs('#parsed-id').value = id;
      qs('#user-id').textContent = `ID: ${id}`;
      qs('#display-name').textContent = name;
      qs('#discord').value = id;
      loadAvatar(id, avatar);
      qs('#whitelist-form').addEventListener('submit', submitForm);
      qs('#lang-en').addEventListener('click', () => setLang('en'));
      qs('#lang-ar').addEventListener('click', () => setLang('ar'));
      setLang('ar');
    });
  </script>
</body>
</html>